<div class="card-columns">
  <div class="card alert alert-secondary" *ngFor="let ass of (companies$ | async)"
       [ngClass]="getClassByCompany(ass.parent.id)"
       [dndDropzone]="['person']"
       (dndDrop)="handler.onDrop(ass.parent.id.toString(), $event)"
  >
    <div *ngIf="isTargetNormal(ass.parent.id)" class="card-header nowrapped-truncated-text">
      <i class="fas fa-industry"></i> [{{ass.parent.id}}] - {{ass.parent.name}}
      <span class="toRight"><app-company-delete [data]="ass.parent"></app-company-delete></span>
      <span class="toRight mr-2" role="button" (click)="editCompany(ass.parent)">
          <i class="fa fa-pen"></i>
        </span>

    </div>
    <div *ngIf="isTargetRubbishBin(ass.parent.id)" class="card-header nowrapped-truncated-text textCenter"><i class="fa fa-trash"></i></div>
    <div *ngIf="isTargetUnemployed(ass.parent.id)" class="card-header nowrapped-truncated-text textCenter" title="Unemployed">
      <i class="fas fa-users-slash"></i>
      <span class="toRight" role="button" (click)="addPerson()">
        <i class="fa fa-plus"></i>
      </span>
    </div>
    <div class="card-body" *ngIf="isTargetNormal(ass.parent.id) || isTargetUnemployed(ass.parent.id)">
      <div *ngFor="let p of ass.children"
           class="alert alert-light draggable" role="alert"
           [dndDraggable]="p"
           dndType="person"
           dndEffectAllowed="move"
           [dndDisableIf]="false"
           (dndStart)="handler.onDragStart(ass.parent.id.toString(), $event)"
           (dndMoved)="handler.onMoved(ass.parent.id.toString(), $event)">
        <i class="fas fa-user"></i> [{{p.id}}] - {{p.name}}
        <span style="float: right"><app-person-delete [data]="p"></app-person-delete></span>
        <span class="toRight mr-2" role="button" (click)="editPerson(p)">
          <i class="fa fa-pen"></i>
        </span>
      </div>
    </div>
  </div>

  <div class="card alert alert-secondary">
    <div class="card-header nowrapped-truncated-text textCenter" role="button" (click)="addCompany()"><i class="fa fa-plus"></i></div>
  </div>
</div>

<hr>

<div class="card-columns">
  <div class="card alert alert-secondary" [dndDropzone]="['person']" (dndDrop)="handler.onDrop(COMPANY_ID_RUBBISH_BIN, $event)"></div>
</div>

<div class="d-flex justify-content-center">
  <div class="spinner-border" role="status" *ngIf="(loadingP$ | async) || (loadingC$ | async)">
    <span class="sr-only">Loading...</span>
  </div>
</div>

<app-company-edit #companyEdit></app-company-edit>
<app-person-edit #personEdit></app-person-edit>
